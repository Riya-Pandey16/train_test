"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[37],{8037:function(e,o,l){l.r(o),l.d(o,{default:function(){return b}});l(4114);var a=l(6768),n=l(5130),t=l(4232),u=l(144),s=l(1714);const r={class:"p-4"},c={class:"flex gap-2 mb-2"},d={class:"flex gap-2 mb-2"},i={class:"mb-2"},v={class:"bg-gray-100 p-2 h-64 overflow-y-scroll border rounded"},p={class:"text-sm"};var m={__name:"SocketTest",setup(e){const o=(0,u.KR)(null),l=(0,u.KR)(""),m=(0,u.KR)(""),k=(0,u.KR)(""),f=(0,u.KR)([]),b=e=>{f.value.push(`[${(new Date).toLocaleTimeString()}] ${e}`)},h=()=>{o.value&&o.value.disconnect(),o.value=(0,s.io)("http://localhost:5000",{transports:["websocket"],auth:{token:l.value}}),o.value.on("connect",(()=>{b("✅ Connected to socket.io")})),o.value.on("disconnect",(()=>{b("❌ Disconnected")})),o.value.on("receive_message",(e=>{b(`📩 Message from ${e.sender_id||"unknown"}: ${e.text||"[file]"}`)})),o.value.on("error",(e=>{b(`⚠️ Socket error: ${e}`)})),o.value.on("connect_error",(e=>{b(`❌ Connect error: ${e.message}`)}))},g=()=>{o.value||h(),o.value.emit("join_room",{room:k.value}),b(`➡️ Joined room ${k.value}`)},x=()=>{o.value&&(o.value.emit("send_message",{room:k.value,text:m.value}),b(`📤 Sent message: ${m.value}`),m.value="")},w=async e=>{const a=e.target.files[0];if(!a)return;const n=new FormData;n.append("file",a);const t=await fetch("http://localhost:5000/api/chat/upload",{method:"POST",headers:{Authorization:`Bearer ${l.value}`},body:n}),u=await t.json();u.url?(b(`📎 File uploaded: ${u.url}`),o.value.emit("send_message",{room:k.value,file_url:u.url,file_name:a.name})):b(`❌ Upload failed: ${u.error||"Unknown error"}`)};return(0,a.xo)((()=>{o.value&&o.value.disconnect()})),(e,o)=>((0,a.uX)(),(0,a.CE)("div",r,[o[3]||(o[3]=(0,a.Lk)("h2",{class:"text-xl font-bold mb-4"},"Socket.IO Test Page",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>l.value=e),placeholder:"JWT Token",class:"border p-2 mb-2 w-full"},null,512),[[n.Jo,l.value]]),(0,a.Lk)("div",c,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>k.value=e),placeholder:"Room ID",class:"border p-2 flex-1"},null,512),[[n.Jo,k.value]]),(0,a.Lk)("button",{onClick:g,class:"bg-blue-500 text-white px-4 py-2 rounded"},"Join")]),(0,a.Lk)("div",d,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>m.value=e),placeholder:"Type a message",class:"border p-2 flex-1"},null,512),[[n.Jo,m.value]]),(0,a.Lk)("button",{onClick:x,class:"bg-green-500 text-white px-4 py-2 rounded"},"Send")]),(0,a.Lk)("div",i,[(0,a.Lk)("input",{type:"file",onChange:w},null,32)]),(0,a.Lk)("div",v,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(f.value,((e,o)=>((0,a.uX)(),(0,a.CE)("div",{key:o,class:"mb-2"},[(0,a.Lk)("pre",p,(0,t.v_)(e),1)])))),128))])]))}},k=l(1241);const f=(0,k.A)(m,[["__scopeId","data-v-555022f6"]]);var b=f}}]);
//# sourceMappingURL=37.57132051.js.map